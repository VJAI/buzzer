<html>
<head>
  <title>Filters Experiment</title>
</head>
<body>
<h1>Filters Experiment</h1>
<div>Status: <span id="status"></span></div>
<button id="play">Play</button>
<button id="stop">Stop</button>
<label for="lowpass">Low Pass</label>
<input id="lowpass" type="radio" name="filter">
<label for="highpass">High Pass</label>
<input id="highpass" type="radio" name="filter">
<script src="bufferloader.js"></script>
<script>
  var audioContext = new (AudioContext || webkitAudioContext)();
  var buffer, gain = audioContext.createGain(), bufferSourceNode;
  var st = document.getElementById('status'), time = document.getElementById('time');
  var filter = audioContext.createBiquadFilter();
  filter.type = 'lowpass';
  filter.frequency.value = 600;
  gain.gain.value = 1.0;
  gain.connect(filter);
  filter.connect(audioContext.destination);

  loadBuffer(audioContext, '../sounds/bg.mp3', function (b) {
    buffer = b;
    st.innerText = "Ready";
  });

  document.getElementById('play').addEventListener('click', function () {
    bufferSourceNode = audioContext.createBufferSource();
    bufferSourceNode.buffer = buffer;
    bufferSourceNode.connect(gain);
    bufferSourceNode.start(0);
  });

  document.getElementById('stop').addEventListener('click', function () {
    bufferSourceNode.stop(0);
    bufferSourceNode.disconnect();
    bufferSourceNode = null;
  });
</script>
</body>
</html>
