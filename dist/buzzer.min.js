!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Buzzer=t():e.Buzzer=t()}(this,function(){return function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=4)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.BuzzerState=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i(1),o=n(u),s={Constructed:0,Ready:1,Done:2,NA:3},c=function(){function e(){r(this,e),this._context=null,this._codecs={},this._muted=!1,this._volume=1,this._gain=null,this._contextType=AudioContext||webkitAudioContext,this._state="undefined"!=typeof this._contextType?s.Constructed:s.NA}return a(e,[{key:"setup",value:function(e){return this._state===s.NA?((0,o.default)("Audio engine is not available because the current platform not supports Web Audio.",u.LogType.Error),!1):this._state===s.Ready||(this._context=e||new this._contextType,this.codecs(),this._gain=this._context.createGain(),this._gain.gain.value=this._volume,this._gain.connect(this._context.destination),this._state=s.Ready,!0)}},{key:"codecs",value:function(){if(0===Object.keys(this._codecs).length&&"undefined"!=typeof Audio){var e=new Audio;this._codecs={mp3:!!e.canPlayType("audio/mp3;").replace(/^no$/,""),mpeg:!!e.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},e=null}return this._codecs}},{key:"volume",value:function e(t){var e=parseFloat(t);return isNaN(e)||e<0||e>1?this._volume:(this._volume=e,this._gain&&(this._gain.gain.value=this._volume),this._volume)}},{key:"mute",value:function(){this._muted||(this._gain&&(this._gain.gain.value=0),this._muted=!0)}},{key:"unmute",value:function(){this._muted&&(this._gain&&(this._gain.gain.value=this._volume),this._muted=!1)}},{key:"tearDown",value:function(){this._state=s.Done}},{key:"context",value:function(){return this._context}},{key:"gain",value:function(){return this._gain}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"available",value:function(){return this._state!==s.NA}}]),e}(),l=new c;t.BuzzerState=s,t.default=l},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={Log:"log",Error:"error",Warn:"warn",Info:"info"},r=function(e,t){return console[t||"log"](e)};t.LogType=n,t.default=r},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ErrorType=t.AudioLoadState=t.BuzzState=void 0;var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i(3),o=n(u),s=i(1),c=n(s),l=i(0),h=n(l),f={Constructed:0,Playing:1,Paused:2,Stopped:3,NA:4},d={NotLoaded:0,Loading:1,Loaded:2,Error:3},_={AudioUnAvailable:1,LoadError:2},p=function(){function e(t){r(this,e),this._id=Math.round(Date.now()*Math.random()),this._src=t.src,this._formats=t.formats,this._volume=t.volume||1,this._loop=t.loop||!1,this._preload=t.preload||!1,this._autoplay=t.autoplay||!1,this._subscribers={load:[],error:[],playstart:[],end:[],stop:[],pause:[],mute:[]};for(var i in this._subscribers)this._subscribers.hasOwnProperty(i)&&"function"==typeof t["on"+i]&&this.on(i,t["on"+i]);if(this._buffer=null,this._bufferSource=null,this._endTimer=null,this._duration=0,this._muted=!1,this._startedAt=0,this._pausedAt=0,h.default.setup(null)){if(this._context=h.default.context(),this._gain=this._context.createGain(),this._gain.connect(h.default.gain()),this._gain.gain.value=this._volume,this._loadStatus=d.NotLoaded,this._state=f.Constructed,this._autoplay)return void this.play();this._preload&&this.load()}else this._state=f.NA,this._fire("error",{type:_.AudioUnAvailable,error:"Web Audio API is unavailable"})}return a(e,[{key:"load",value:function(){if(!this._check())return this;if(this._loadStatus===d.Loading||this._loadStatus===d.Loaded)return this;var e=function(e){this._buffer=e,this._duration=e.duration,this._loadStatus=d.Loaded,this._fire("load",e)}.bind(this);if(o.default.exists(this._src))return e(o.default.retrieve(this._src)),this;this._loadStatus=d.Loading;var t=new XMLHttpRequest;t.open("GET",this._src,!0),t.responseType="arraybuffer";var i=function(){this._context.decodeAudioData(t.response,function(t){o.default.store(this._src,t),e(t)}.bind(this),n)},n=function(e){this._loadStatus=d.Error,this._fire("error",{type:_.LoadError,error:e})};return t.addEventListener("load",i.bind(this)),t.addEventListener("error",n.bind(this)),t.send(),this}},{key:"play",value:function e(){if(!this._check())return this;if(this._state===f.Playing)return this;var e=function(){this._endTimer&&(clearTimeout(this._endTimer),this._endTimer=null);var e=this._pausedAt;return this._bufferSource=this._context.createBufferSource(),this._bufferSource.buffer=this._buffer,this._bufferSource.connect(this._gain),this._bufferSource.start(0,e),this._startedAt=this._context.currentTime-e,this._pausedAt=0,this._endTimer=setTimeout(t,1e3*this._duration),this._state=f.Playing,this._fire("playstart"),this}.bind(this),t=function(){this._startedAt=0,this._pausedAt=0,this._endTimer=null,this._state=f.Stopped,this._fire("end")}.bind(this);return this._loadStatus===d.Loaded?e():(this.on("load",e,!0),this.load(),this)}},{key:"stop",value:function(){return this._check()?this._state!==f.Playing&&this._state!==f.Paused?this:(this._bufferSource.disconnect(),this._bufferSource.stop(0),this._bufferSource=null,this._endTimer&&clearTimeout(this._endTimer),this._endTimer=null,this._pausedAt=0,this._startedAt=0,this._state=f.Stopped,this._fire("stop"),this):this}},{key:"pause",value:function(){if(!this._check())return this;if(this._state!==f.Playing)return this;var e=this._context.currentTime-this._startedAt;return this._bufferSource.disconnect(),this._bufferSource.stop(0),this._bufferSource=null,this._endTimer&&clearTimeout(this._endTimer),this._endTimer=null,this._startedAt=0,this._pausedAt=e,this._state=f.Paused,this._fire("pause"),this}},{key:"mute",value:function(){return this._muted?this:(this._gain&&(this._gain.gain.value=0),this._muted=!0,this)}},{key:"unmute",value:function(){if(this._muted)return this._gain&&(this._gain.gain.value=this._volume),this._muted=!1,this}},{key:"volume",value:function e(t){if("undefined"==typeof t)return this._volume;var e=parseFloat(t);return isNaN(e)||e<0||e>1?this:(this._volume=e,this._gain&&(this._gain.gain.value=this._volume),this)}},{key:"fadeOut",value:function(){throw new Error("Not Implemented")}},{key:"fadeIn",value:function(){throw new Error("Not Implemented")}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"duration",value:function(){return this._duration}},{key:"on",value:function(e,t,i){return this._subscribers.hasOwnProperty(e)?"function"!=typeof t?this:(this._subscribers[e].push({fn:t,once:i}),this):this}},{key:"off",value:function(e,t){if(!this._subscribers.hasOwnProperty(e))return this;if("function"!=typeof t)return this;for(var i=this._subscribers[e],n=0;n<i.length;n++){var r=i[n];if(r.fn===t){i.splice(n,1);break}}return this}},{key:"once",value:function(e,t){return this.on(e,t,!0)}},{key:"_fire",value:function(e,t){for(var i=this._subscribers[e],n=0;n<i.length;n++){var r=i[n];setTimeout(function(i){i.fn(this,t),i.once&&this.off(e,i.fn)}.bind(this,r),0)}return this}},{key:"_check",value:function(){return this._state!==f.NA||((0,c.default)("Web Audio API is unavailable",s.LogType.Error),!1)}}]),e}();t.BuzzState=f,t.AudioLoadState=d,t.ErrorType=_,t.default=p},function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this._cache={}}return r(e,[{key:"store",value:function(e,t){this._cache[e]=t}},{key:"retrieve",value:function(e){return this._cache[e]}},{key:"remove",value:function(e){delete this._cache[e]}},{key:"count",value:function(){return Object.keys(this._cache).length}},{key:"exists",value:function(e){return this._cache.hasOwnProperty(e)}},{key:"flush",value:function(){this._cache={}}}]),e}(),u=new a;t.default=u},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Buzz=t.buzzer=void 0;var r=i(0),a=n(r),u=i(2),o=n(u);t.buzzer=a.default,t.Buzz=o.default}])});
//# sourceMappingURL=buzzer.min.js.map