/*!
*  musquito v2.0.2 
*  http://musquitojs.com
*
*  (c) 2020 Vijaya Anand
*  http://prideparrot.com
*
*  MIT License
*/
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("$buzz",[],t):"object"==typeof exports?exports.$buzz=t():e.$buzz=t()}(window,(function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._navigator=null,this._contextType=null,this._formats={},this._userAgent=null,"undefined"!=typeof navigator&&(this._navigator=navigator,this._userAgent=navigator.userAgent),"undefined"!=typeof AudioContext?this._contextType=AudioContext:"undefined"!=typeof webkitAudioContext&&(this._contextType=webkitAudioContext);var t=new Audio;this._formats={mp3:Boolean(t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:Boolean(t.canPlayType("audio/mpeg;").replace(/^no$/,"")),opus:Boolean(t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")),ogg:Boolean(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),oga:Boolean(t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")),wav:Boolean(t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")),aac:Boolean(t.canPlayType("audio/aac;").replace(/^no$/,"")),caf:Boolean(t.canPlayType("audio/x-caf;").replace(/^no$/,"")),m4a:Boolean((t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")),mp4:Boolean((t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,"")),weba:Boolean(t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:Boolean(t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:Boolean(t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,"")),flac:Boolean((t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,""))},t=null}return i(e,[{key:"id",value:function(){return Math.round(Date.now()*Math.random())}},{key:"getContextType",value:function(){return this._contextType}},{key:"getContext",value:function(){return new this._contextType}},{key:"supportedFormats",value:function(){return this._formats}},{key:"isFormatSupported",value:function(e){return Boolean(this._formats[e])}},{key:"getSupportedFormat",value:function(e){var t=this;return e.find((function(e){return t.isFormatSupported(e)}))}},{key:"isSourceSupported",value:function(e){var t=this.isBase64(e)?/^data:audio\/([^;,]+);/i.exec(e):/^.+\.([^.]+)$/.exec(e);return!!(t=/^.+\.([^.]+)$/.exec(e))&&this.isFormatSupported(t[1].toLowerCase())}},{key:"getSupportedSource",value:function(e){var t=this;return e.find((function(e){return t.isSourceSupported(e)}))}},{key:"isBase64",value:function(e){return/^data:[^;]+;base64,/.test(e)}},{key:"_isMobile",value:function(){return!!this._navigator&&/iPhone|iPad|iPod|Android|BlackBerry|BB10|Silk|Mobi/i.test(this._userAgent)}},{key:"_isTouch",value:function(){return"undefined"!=typeof window&&Boolean("ontouchend"in window||this._navigator&&this._navigator.maxTouchPoints>0||this._navigator&&this._navigator.msMaxTouchPoints>0)}},{key:"isIE",value:function(){return Boolean(this._userAgent&&/MSIE |Trident\//.test(this._userAgent))}}]),e}();t.default=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=n(3),o=(i=r)&&i.__esModule?i:{default:i};t.default=function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url=null,this.value=null,this.error=null,this.status=null,this.url=t,this.value=n,this.error=i||null,this.status=i?o.default.Failure:o.default.Success}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorType=t.EngineEvents=t.EngineState=t.default=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=h(n(7)),o=h(n(8)),a=h(n(4)),s=h(n(10)),u=h(n(5)),l=h(n(0)),d=h(n(11));function h(e){return e&&e.__esModule?e:{default:e}}var c={NoAudio:"no-audio",LoadError:"load",PlayError:"play",EngineError:"engine"},f={NotReady:"notready",Ready:"ready",Suspending:"suspending",Suspended:"suspended",Resuming:"resuming",Destroying:"destroying",Done:"done",NoAudio:"no-audio"},_={Add:"add",Remove:"remove",Volume:"volume",Mute:"mute",Pause:"pause",Stop:"stop",Suspend:"suspend",Resume:"resume",Error:"error",Done:"done"},p=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","pointerup","touchend","keydown","keyup"],y=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=l.default.id(),this._muted=!1,this._volume=1,this._maxNodesPerSource=10,this._cleanUpInterval=5,this._inactiveTime=2,this._autoEnable=!0,this._intervalId=null,this._isAudioAvailable=!1,this._state=f.NotReady,this._context=null,this._gainNode=null,this._queue=null,this._heap=null,this._bufferLoader=null,this._mediaLoader=null,this._heap=new s.default(this._inactiveTime),this._queue=new u.default,this._resumeAndRemoveListeners=this._resumeAndRemoveListeners.bind(this)}return i(e,[{key:"setup",value:function(e){var t=this;if(this._state!==f.NotReady)return this;if(this._context=l.default.getContext(),this._isAudioAvailable=Boolean(this._context),!this._isAudioAvailable)return this._state=f.NoAudio,this._fire(_.Error,{type:c.NoAudio,error:"Web Audio API is not available"}),this;var n=e||{},i=n.volume,a=n.muted,s=n.maxNodesPerSource,u=n.cleanUpInterval,d=n.autoEnable,h=n.onadd,y=n.onremove,v=n.onstop,m=n.onpause,b=n.onmute,g=n.onvolume,k=n.onsuspend,S=n.onresume,E=n.onerror,P=n.ondone;return"number"==typeof i&&i>=0&&i<=1&&(this._volume=i),"boolean"==typeof a&&(this._muted=a),"number"==typeof s&&(this._maxNodesPerSource=s),"number"==typeof u&&(this._cleanUpInterval=u),"boolean"==typeof d&&(this._autoEnable=d),"function"==typeof h&&this.on(_.Add,h),"function"==typeof y&&this.on(_.Remove,y),"function"==typeof v&&this.on(_.Stop,v),"function"==typeof m&&this.on(_.Pause,m),"function"==typeof b&&this.on(_.Mute,b),"function"==typeof g&&this.on(_.Volume,g),"function"==typeof k&&this.on(_.Suspend,k),"function"==typeof S&&this.on(_.Resume,S),"function"==typeof E&&this.on(_.Error,E),"function"==typeof P&&this.on(_.Done,P),this._bufferLoader=new r.default(this._context),this._mediaLoader=new o.default(this._maxNodesPerSource,this._heap),this._autoEnable&&"suspended"===this._context.state&&p.forEach((function(e){return document.addEventListener(e,t._resumeAndRemoveListeners)})),this._gainNode=this._context.createGain(),this._gainNode.gain.setValueAtTime(this._muted?0:this._volume,this._context.currentTime),this._gainNode.connect(this._context.destination),this._intervalId=window.setInterval(this._heap.free,60*this._cleanUpInterval*1e3),this._state="suspended"!==this._context.state?f.Ready:f.Suspended,this}},{key:"load",value:function(e,t){return this._bufferLoader.load(e,t)}},{key:"loadMedia",value:function(e){return this._mediaLoader.load(e)}},{key:"allocateForGroup",value:function(e,t){return this._mediaLoader.allocateForGroup(e,t)}},{key:"allocateForSound",value:function(e,t,n){return this._mediaLoader.allocateForSound(e,t,n)}},{key:"unload",value:function(e){return e?(this._bufferLoader.unload(e),this):(this._bufferLoader.unload(),this)}},{key:"unloadMedia",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?(this._mediaLoader.unload(e,t),this):(this._mediaLoader.unload(null,t),this)}},{key:"releaseForGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this._mediaLoader.releaseForGroup(e,t,n),this}},{key:"releaseForSound",value:function(e,t,n){this._mediaLoader.releaseForSound(e,t,n)}},{key:"hasFreeNodes",value:function(e,t){return this._mediaLoader.hasFreeNodes(e,t)}},{key:"mute",value:function(){return this._muted?this:(this._gainNode.gain.setValueAtTime(0,this._context.currentTime),this._muted=!0,this._fire(_.Mute,this._muted),this)}},{key:"unmute",value:function(){return this._muted?(this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime),this._muted=!1,this._fire(_.Mute,this._muted),this):this}},{key:"volume",value:function(e){return void 0===e?this._volume:"number"!=typeof e||e<0||e>1?this:(this._gainNode.gain.setValueAtTime(this._muted?0:e,this._context.currentTime),this._volume=e,this._fire(_.Volume,this._volume),this)}},{key:"stop",value:function(){return this._heap.sounds().forEach((function(e){return e.stop()})),this._fire(_.Stop),this}},{key:"suspend",value:function(){var e=this;return this._state===f.Resuming?(this._queue.add("after-resume","suspend",(function(){return e.suspend()})),this):this._state!==f.Ready?this:(this.stop(),this._state=f.Suspending,this._context.suspend().then((function(){e._state=f.Suspended,e._queue.run("after-suspend"),e._fire(_.Suspend)})),this)}},{key:"resume",value:function(){var e=this;return this._state===f.Suspending?(this._queue.add("after-suspend","resume",(function(){return e.resume()})),this):this._state!==f.Suspended?this:(this._state=f.Resuming,this._context.resume().then((function(){e._state=f.Ready,e._queue.run("after-resume"),e._fire(_.Resume)})),this)}},{key:"terminate",value:function(){var e=this;if(this._state===f.Done||this._state===f.Destroying)return this;var t=function(){p.forEach((function(t){return document.addEventListener(t,e._resumeAndRemoveListeners)})),e._intervalId&&window.clearInterval(e._intervalId),e._intervalId=null,e._heap.destroy(),e._heap=null,e._bufferLoader&&(e._bufferLoader.dispose(),e._bufferLoader=null),e._mediaLoader&&(e._mediaLoader.dispose(),e._mediaLoader=null),e._context=null,e._queue.clear(),e._queue=null,e._state=f.Done,e._fire(_.Done),a.default.clear(e._id)};if(this._context){if(this._state===f.Suspending)return this._queue.remove("after-suspend"),this._queue.add("after-suspend","destroy",(function(){return e.terminate()})),this;if(this._state===f.Resuming)return this._queue.remove("after-resume"),this._queue.add("after-resume","destroy",(function(){return e.terminate()})),this;this._state=f.Destroying,this._context&&this._context.close().then((function(){return t()}))}else this._state=f.Destroying,t();return this}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.default.on(this._id,e,t,n),this}},{key:"off",value:function(e,t){return a.default.off(this._id,e,t),this}},{key:"sound",value:function(e,t,n){if("number"==typeof e)return this._heap.sound(e);var i=new d.default(n);return this._heap.add(e,t,i),i._gain().connect(this._gainNode),i}},{key:"removeSound",value:function(e,t,n){this._heap.removeSound(e,t,n)}},{key:"sounds",value:function(e){return this._heap.sounds(e)}},{key:"free",value:function(e,t,n){return this._heap.free(e,t,n),this._mediaLoader.cleanUp(),this}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"context",value:function(){return this._context}},{key:"masterGain",value:function(){return this._gainNode}},{key:"isAudioAvailable",value:function(){return this._isAudioAvailable}},{key:"bufferLoader",value:function(){return this._bufferLoader}},{key:"mediaLoader",value:function(){return this._mediaLoader}},{key:"_fire",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return a.default.fire.apply(a.default,[this._id,e].concat(n,[this])),this}},{key:"_resumeAndRemoveListeners",value:function(){var e=this;this.resume(),p.forEach((function(t){return document.addEventListener(t,e._resumeAndRemoveListeners)}))}}]),e}());t.default=y,t.EngineState=f,t.EngineEvents=_,t.ErrorType=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={Success:"success",Failure:"error"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._objectsEventsHandlersMap={}}return i(e,[{key:"on",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this._hasObject(e)||(this._objectsEventsHandlersMap[e]={});var r=this._objectsEventsHandlersMap[e];return r.hasOwnProperty(t)||(r[t]=[]),r[t].push({handler:n,once:i}),this}},{key:"off",value:function(e,t,n){if(!this._hasEvent(e,t))return this;var i=this._objectsEventsHandlersMap[e];return i[t]=n?i[t].filter((function(e){return e.handler!==n})):[],this}},{key:"fire",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];if(!this._hasEvent(e,t))return this;for(var o=this._objectsEventsHandlersMap[e][t],a=0;a<o.length;a++){var s=o[a];setTimeout(function(n){var r=n.handler,o=n.once;r.apply(void 0,i),o&&this.off(e,t,r)}.bind(this,s),0)}return this}},{key:"clear",value:function(e){return e?(this._hasObject(e)&&delete this._objectsEventsHandlersMap[e],this):(this._objectsEventsHandlersMap={},this)}},{key:"_hasObject",value:function(e){return this._objectsEventsHandlersMap.hasOwnProperty(e)}},{key:"_hasEvent",value:function(e,t){return this._hasObject(e)&&this._objectsEventsHandlersMap[e].hasOwnProperty(t)}}]),e}();t.default=new r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._eventActions={}}return i(e,[{key:"add",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.hasEvent(e)||(this._eventActions[e]={}),this._eventActions[e][t]={fn:n,removeAfterRun:i}}},{key:"hasEvent",value:function(e){return this._eventActions.hasOwnProperty(e)}},{key:"hasAction",value:function(e,t){return!!this.hasEvent(e)&&this._eventActions[e].hasOwnProperty(t)}},{key:"run",value:function(e,t){var n=this;if(this.hasEvent(e))if(void 0===t)Object.keys(this._eventActions[e]).forEach((function(t){return n._run(e,t)}));else{if(!this.hasAction(e,t))return;this._run(e,t)}}},{key:"remove",value:function(e,t){this._eventActions.hasOwnProperty(e)&&(t?delete this._eventActions[e][t]:delete this._eventActions[e])}},{key:"clear",value:function(){this._eventActions={}}},{key:"_run",value:function(e,t){var n=this._eventActions[e][t];n.fn(),n.removeAfterRun&&this.remove(e,t)}}]),e}();t.default=r},function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(2),a=h(o),s=h(n(5)),u=h(n(0)),l=h(n(4)),d=h(n(3));function h(e){return e&&e.__esModule?e:{default:e}}var c={Ready:"ready",Destroyed:"destroyed"},f={Load:"load",LoadProgress:"loadprogress",UnLoad:"unload",PlayStart:"playstart",PlayEnd:"playend",Pause:"pause",Stop:"stop",Volume:"volume",Mute:"mute",Seek:"seek",Rate:"rate",FadeStart:"fadestart",FadeEnd:"fadeend",FadeStop:"fadestop",Error:"error",Destroy:"destroy"},_={NotLoaded:"notloaded",Loading:"loading",Loaded:"loaded",AudioUnLoad:"audio-unload"},p=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=-1,this._src=null,this._format=[],this._sprite=null,this._volume=1,this._rate=1,this._muted=!1,this._loop=!1,this._preload=!1,this._autoplay=!1,this._stream=!1,this._duration=0,this._compatibleSrc=null,this._loadState=_.NotLoaded,this._state=c.Ready,this._queue=null,this._engine=null,this._fading=!1,this._fadeTimer=null,this._noOfLoadCalls=0,this._onLoadProgress=this._onLoadProgress.bind(this),this._engine=a.default,this._engine.setup(),this._engine.on(o.EngineEvents.Resume,this._onEngineResume=this._onEngineResume.bind(this)),!this._engine.isAudioAvailable())return this._fire(f.Error,null,{type:o.ErrorType.NoAudio,error:"Web Audio is un-available"}),this;if("string"==typeof t)this._src=[t];else if(Array.isArray(t)&&t.length)this._src=t;else if("object"===(void 0===t?"undefined":i(t))){var n=t.id,r=t.src,l=t.format,d=t.sprite,h=t.volume,p=t.rate,y=t.muted,v=t.loop,m=t.autoplay,b=t.stream,g=t.preload,k=t.onload,S=t.onloadprogress,E=t.onunload,P=t.onplaystart,A=t.onplayend,T=t.onstop,w=t.onpause,N=t.onmute,L=t.onvolume,C=t.onrate,x=t.onseek,M=t.onerror,O=t.ondestroy;this._id="number"==typeof n?n:u.default.id(),"string"==typeof r?this._src=[r]:Array.isArray(r)&&r.length&&(this._src=r),Array.isArray(l)?this._format=l:"string"==typeof l&&l&&(this._format=[l]),"object"===(void 0===d?"undefined":i(d))&&(this._sprite=d),"number"==typeof h&&h>=0&&h<=1&&(this._volume=h),"number"==typeof p&&p>=.5&&p<=5&&(this._rate=p),"boolean"==typeof y&&(this._muted=y),"boolean"==typeof v&&(this._loop=v),"boolean"==typeof m&&(this._autoplay=m),"boolean"==typeof b&&(this._stream=b),"boolean"==typeof g&&(this._preload=g),"function"==typeof k&&this.on(f.Load,k),"function"==typeof S&&this.on(f.LoadProgress,S),"function"==typeof E&&this.on(f.UnLoad,E),"function"==typeof P&&this.on(f.PlayStart,P),"function"==typeof A&&this.on(f.PlayEnd,A),"function"==typeof T&&this.on(f.Stop,T),"function"==typeof w&&this.on(f.Pause,w),"function"==typeof N&&this.on(f.Mute,N),"function"==typeof L&&this.on(f.Volume,L),"function"==typeof C&&this.on(f.Rate,C),"function"==typeof x&&this.on(f.Seek,x),"function"==typeof M&&this.on(f.Error,M),"function"==typeof O&&this.on(f.Destroy,O)}if(!this._src)throw new Error("You should pass the source for the audio.");this._queue=new s.default,this._autoplay?this.play():this._preload&&this.load()}return r(e,[{key:"load",value:function(e){var t=this;if(e){var n=this.sound(e);return n&&n.load(),this}if(!this._stream&&(this.isLoaded()||this._loadState===_.Loading))return this;this._loadState=_.Loading,this._noOfLoadCalls=this._noOfLoadCalls+1;var i=this._compatibleSrc||(this._compatibleSrc=this.getCompatibleSource());return(this._stream?this._engine.allocateForGroup(i,this._id):this._engine.load(i,this._onLoadProgress)).then((function(e){if(t._noOfLoadCalls>0&&(t._noOfLoadCalls=t._noOfLoadCalls-1),!t._stream||t._state!==c.Destroyed&&t._loadState!==_.AudioUnLoad){if(t._state!==c.Destroyed&&t._loadState!==_.NotLoaded)return e.status===d.default.Success?(t._stream?t._duration=e.value.duration:(t._buffer=e.value,t._duration=t._buffer.duration),t._loadState=_.Loaded,t._fire(f.Load,null,e),void t._queue.run("after-load")):void t._onLoadFailure(e.error)}else t._engine.releaseForGroup(t._compatibleSrc,t._id,t._state!==c.Destroyed)})),this}},{key:"getCompatibleSource",value:function(){return this._format.length?this._src[this._format.indexOf(u.default.getSupportedFormat(this._format))]:u.default.getSupportedSource(this._src)}},{key:"play",value:function(e){var t=this;if("number"==typeof e){var n=this._engine.sound(e);return n&&this._play(n),this}var i=u.default.id(),r=function(){var n={id:i,buffer:t._buffer,stream:t._stream,audio:t._stream?t._engine.allocateForSound(t._compatibleSrc,t._id,i):null,volume:t._volume,rate:t._rate,muted:t._muted,loop:t._loop,playEndCallback:function(){return t._fire(f.PlayEnd,i)},destroyCallback:function(){t._engine.releaseForSound(t._compatibleSrc,i,t._id),t._engine.removeSound(t._compatibleSrc,t._id,i),t._fire(f.Destroy,i),l.default.clear(i)},fadeEndCallback:function(){return t._fire(f.FadeEnd,i)},audioErrorCallback:function(e,n){t._fire(f.Error,{type:o.ErrorType.LoadError,soundId:i,error:n}),t._engine.releaseForSound(t._compatibleSrc,t._id,i),e.destroy()},loadCallback:function(){t._fire(f.Load,i)}};if("string"==typeof e&&t._sprite&&t._sprite.hasOwnProperty(e)){var r=t._sprite[e];n.startPos=r[0],n.endPos=r[1]}var a=t._engine.sound(t._compatibleSrc,t._id,n);t._play(a)};return this.isLoaded()?r():(this._queue.add("after-load","play-"+i,(function(){return r()})),this.load()),i}},{key:"pause",value:function(e){return this._removePlayActions(e),"number"!=typeof e&&this.fadeStop(),this._sounds(e).forEach((function(e){return e.pause()})),this._fire(f.Pause,e),this}},{key:"stop",value:function(e){return this._removePlayActions(e),"number"!=typeof e&&this.fadeStop(),this._sounds(e).forEach((function(e){return e.stop()})),this._fire(f.Stop,e),this}},{key:"mute",value:function(e){var t="number"!=typeof e;return t&&this.fadeStop(),this._sounds(e).forEach((function(e){return e.mute()})),t&&(this._muted=!0),this._fire(f.Mute,e,this._muted),this}},{key:"unmute",value:function(e){var t="number"!=typeof e;return t&&this.fadeStop(),this._sounds(e).forEach((function(e){return e.unmute()})),t&&(this._muted=!1),this._fire(f.Mute,e,this._muted),this}},{key:"volume",value:function(e,t){var n="number"!=typeof t;if("number"==typeof e&&e>=0&&e<=1)return n&&this.fadeStop(),this._sounds(t).forEach((function(t){return t.volume(e)})),"number"!=typeof t&&(this._volume=e),this._fire(f.Volume,t,this._volume),this;if(!n){var i=this._engine.sound(t);return i?i.volume():null}return this._volume}},{key:"fade",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",r=arguments[3],o="number"!=typeof r;return o&&this._fading?this:(this._fire(f.FadeStart,r),this._sounds(r).forEach((function(n){return n.fade(e,t,i)})),o&&(this._fading=!0,this._fadeTimer=setTimeout((function(){n.volume(e),clearTimeout(n._fadeTimer),n._fadeTimer=null,n._fading=!1,n._fire(f.FadeEnd)}),1e3*t)),this)}},{key:"fadeStop",value:function(e){var t="number"!=typeof e;return t&&!this._fading?this:(this._sounds(e).forEach((function(e){return e.fadeStop()})),t&&(this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null),this._fading=!1),this._fire(f.FadeStop,e),this)}},{key:"rate",value:function(e,t){if("number"==typeof e&&e>=.5&&e<=5)return this._sounds(t).forEach((function(t){return t.rate(e)})),"number"!=typeof t&&(this._rate=e),this._fire(f.Rate,t,this._rate),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.rate():null}return this._rate}},{key:"seek",value:function(e,t){var n=this;if(!e)return this;var i=this.sound(e);return i?"number"==typeof t?this.isLoaded()?(i.seek(t),this._fire(f.Seek,e,t),this):(this._queue.add("after-load","seek-"+e,(function(){return n.seek(e,t)})),this.load(),this):i.seek():this}},{key:"loop",value:function(e,t){if("boolean"==typeof e)return this._sounds(t).forEach((function(t){return t.loop(e)})),"number"!=typeof t&&(this._loop=e),this;if("number"==typeof t){var n=this._engine.sound(t);return n?n.loop():null}return this._loop}},{key:"playing",value:function(e){var t=this._engine.sound(e);return t?t.isPlaying():null}},{key:"muted",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.muted():null}return this._muted}},{key:"state",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.state():null}return this._state}},{key:"duration",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?t.duration():null}return this._duration}},{key:"unload",value:function(){return this._queue.remove("after-load"),this._stream&&this._engine.releaseForGroup(this._compatibleSrc,this._id,!0),this._buffer=null,this._stream&&(this._duration=0),this._loadState=this._stream?_.AudioUnLoad:_.NotLoaded,this._noOfLoadCalls=0,this}},{key:"destroy",value:function(e){if(e){var t=this.sound(e);t&&t.destroy()}else this._state!==c.Destroyed&&(this.stop(),this._queue.clear(),this._engine.off(o.EngineEvents.Resume,this._onEngineResume),this._engine.free(!1,this._compatibleSrc,this._id),this._engine.releaseForGroup(this._compatibleSrc,this._id),this._buffer=null,this._queue=null,this._engine=null,this._state=c.Destroyed,this._fire(f.Destroy),l.default.clear(this._id))}},{key:"persist",value:function(e){var t=this.sound(e);t&&t.persist()}},{key:"abandon",value:function(e){var t=this.sound(e);t&&t.abandon()}},{key:"on",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments[3];return l.default.on(i||this._id,e,t,n),this}},{key:"off",value:function(e,t,n){return l.default.off(n||this._id,e,t),this}},{key:"id",value:function(){return this._id}},{key:"loadState",value:function(){return this._loadState}},{key:"isLoaded",value:function(){return this._stream?this._engine.hasFreeNodes(this._compatibleSrc,this._id):this._loadState===_.Loaded}},{key:"sound",value:function(e){return this._engine.sound(e)}},{key:"alive",value:function(e){return Boolean(this.sound(e))}},{key:"_onLoadFailure",value:function(e){0===this._noOfLoadCalls&&this._queue.remove("after-load"),this._loadState=_.NotLoaded,this._fire(f.Error,null,{type:o.ErrorType.LoadError,error:e})}},{key:"_onLoadProgress",value:function(e){this._fire(f.LoadProgress,null,e.percentageDownloaded)}},{key:"_onEngineResume",value:function(){this._queue.run("after-engine-resume")}},{key:"_play",value:function(e){var t=this;if(this._engine.state()!==o.EngineState.Destroying&&this._engine.state()!==o.EngineState.Done)if(this._engine.state()!==o.EngineState.NoAudio){var n=function(){e.play(),t._fire(f.PlayStart,e.id())};if([o.EngineState.Suspending,o.EngineState.Suspended,o.EngineState.Resuming].indexOf(this._engine.state())>-1)return this._queue.add("after-engine-resume","sound-"+e.id(),(function(){return n()})),void(this._engine.state()!==o.EngineState.Resuming&&this._engine.resume());n()}else this._fire(f.Error,null,{type:o.ErrorType.NoAudio,error:"Web Audio is un-available"});else this._fire(f.Error,null,{type:o.ErrorType.PlayError,error:"The engine is stopping/stopped"})}},{key:"_removePlayActions",value:function(e){this._queue.remove("after-load",e?"play-"+e:null),this._queue.remove("after-engine-resume",e?"sound-"+e:null)}},{key:"_sounds",value:function(e){if("number"==typeof e){var t=this._engine.sound(e);return t?[t]:[]}return this._engine.sounds(this._id)}},{key:"_fire",value:function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return t?(l.default.fire.apply(l.default,[t,e].concat(i,[this.sound(t),this])),l.default.fire.apply(l.default,[this._id,e].concat(i,[this.sound(t),this]))):l.default.fire.apply(l.default,[this._id,e].concat(i,[this])),this}}]),e}(),y=function(e){return new p(e)};["setup","load","loadMedia","unload","unloadMedia","mute","unmute","volume","stop","suspend","resume","terminate","muted","state","context","masterGain","isAudioAvailable","bufferLoader","mediaLoader","on","off"].forEach((function(e){y[e]=function(){var t=a.default[e].apply(a.default,arguments);return t===a.default?y:t}})),e.exports=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=a(n(0)),o=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._context=null,this._bufferCache={},this._progressCallsAndCallbacks={},this._disposed=!1,this._context=t}return i(e,[{key:"load",value:function(e,t){var n=this;return"string"==typeof e?this._load(e,t):Promise.all(e.map((function(e){return n._load(e,t)})))}},{key:"unload",value:function(e){var t=this;"string"!=typeof e?Array.isArray(e)?e.forEach((function(e){return t._unload(e)}),this):this._bufferCache={}:this._unload(e)}},{key:"dispose",value:function(){this._disposed||(this.unload(),this._bufferCache=null,this._progressCallsAndCallbacks=null,this._context=null,this._disposed=!0)}},{key:"_load",value:function(e,t){var n=this;return new Promise((function(i){if(n._bufferCache.hasOwnProperty(e))i(new o.default(e,n._bufferCache[e]));else if(n._progressCallsAndCallbacks.hasOwnProperty(e))n._progressCallsAndCallbacks[e].push(i);else{n._progressCallsAndCallbacks[e]=[],n._progressCallsAndCallbacks[e].push(i);var a=function(t){n._disposed||(n._progressCallsAndCallbacks[e].forEach((function(n){return n(new o.default(e,null,t))})),delete n._progressCallsAndCallbacks[e])},s=function(t){n._disposed||n._context.decodeAudioData(t,(function(t){n._bufferCache[e]=t,n._progressCallsAndCallbacks[e].forEach((function(n){return n(new o.default(e,t))})),delete n._progressCallsAndCallbacks[e]}),a)};if(r.default.isBase64(e)){for(var u=atob(e.split(",")[1]),l=new Uint8Array(u.length),d=0;d<u.length;d++)l[d]=u.charCodeAt(d);s(l.buffer)}else{var h=new XMLHttpRequest;h.open("GET",e,!0),h.responseType="arraybuffer",h.addEventListener("load",(function(){return s(h.response)}),!1),t&&h.addEventListener("progress",(function(n){n.lengthComputable||t({url:e,percentageDownloaded:0});var i=Math.round(n.loaded/n.total*100);t({url:e,percentageDownloaded:i})})),h.addEventListener("error",a,!1),h.send()}}}))}},{key:"_unload",value:function(e){delete this._bufferCache[e]}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=s(n(9)),a=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._audioPool=null,this._bufferingAudios=[],this._disposed=!1,this._audioPool=new o.default(t,n)}return r(e,[{key:"load",value:function(e){var t=this;return console.log(void 0===e?"undefined":i(e)),"string"==typeof e?this._load(e):Promise.all(e.map((function(e){return t._load(e)})))}},{key:"allocateForGroup",value:function(e,t){return this._load(e,t)}},{key:"allocateForSound",value:function(e,t,n){return this._audioPool.allocateForSound(e,t,n)}},{key:"unload",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=function(e){var n=t._bufferingAudios.find((function(t){return t.url===e}));n&&t._cleanUp(n)};e?"string"==typeof e?(i(e),this._audioPool.releaseForSource(e,n)):Array.isArray(e)&&e.length&&e.forEach((function(e){i(e),t._audioPool.releaseForSource(e,n)})):(this._bufferingAudios.forEach((function(e){return t._cleanUp(e)})),this._audioPool.release(n))}},{key:"releaseForGroup",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._bufferingAudios.filter((function(e){return e.groupId===t})).forEach((function(e){return n._cleanUp(e)})),this._audioPool.releaseForGroup(e,t,i)}},{key:"releaseForSound",value:function(e,t,n){this._audioPool.releaseForSound(e,t,n)}},{key:"hasFreeNodes",value:function(e,t){return this._audioPool.hasFreeNodes(e,t)}},{key:"cleanUp",value:function(){this._audioPool.cleanUp()}},{key:"dispose",value:function(){var e=this;this._disposed||([].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this._bufferingAudios)).forEach((function(t){return e._cleanUp(t)})),this._bufferingAudios=null,this._audioPool.dispose(),this._audioPool=null,this._disposed=!0)}},{key:"_load",value:function(e,t){var n=this;return new Promise((function(i){var r=t?n._audioPool.allocateForGroup(e,t):n._audioPool.allocateForSource(e),o=function(){if(!n._disposed){var t=n._bufferingAudios.find((function(e){return e.audio===r}));t&&n._cleanUp(t),i(new a.default(e,r))}},s=function(o){if(!n._disposed){var s=n._bufferingAudios.find((function(e){return e.audio===r}));s&&n._cleanUp(s),n._audioPool.releaseForSound(e,r,t),i(new a.default(e,null,o))}};if(r.addEventListener("canplaythrough",o),r.addEventListener("error",s),n._bufferingAudios.push({url:e,groupId:t,audio:r,canplaythrough:o,error:s}),!r.src)return r.src=e,void r.load();r.currentTime=0,r.readyState>=3&&o()}))}},{key:"_cleanUp",value:function(e){["canplaythrough","error"].forEach((function(t){return e.audio.removeEventListener(t,e[e])})),this._bufferingAudios.splice(this._bufferingAudios.indexOf(e),1)}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=n(0),a=(i=o)&&i.__esModule?i:{default:i};function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._maxNodesPerSource=100,this._heap=null,this._resourceNodesMap={},this._heapCleaned=!1,this._maxNodesPerSource=t,this._heap=n}return r(e,[{key:"allocateForSource",value:function(e){this._createSrc(e),this._checkMaxNodesForSrc(e);var t=this._resourceNodesMap[e].unallocated,n=new Audio;return t.push(n),n}},{key:"allocateForGroup",value:function(e,t){this._createGroup(e,t),this._checkMaxNodesForSrc(e);var n=this._resourceNodesMap[e],i=n.unallocated,r=n.allocated,o=i.length?i.shift():new Audio;return r[t].push({audio:o,soundId:null}),o}},{key:"allocateForSound",value:function(e,t,n){this._createGroup(e,t);var i=this._resourceNodesMap[e].allocated[t].find((function(e){return null===e.soundId}));if(!i)throw new Error("No free audio nodes available in the group "+t);return i.soundId=n,i.audio}},{key:"release",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object.keys(this._resourceNodesMap).forEach((function(n){return e.releaseForSource(n,t)}))}},{key:"releaseForSource",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this._resourceNodesMap[e],r=i.unallocated,o=i.allocated;r.forEach((function(e){return t._destroyNode(e)})),Object.keys(o).forEach((function(i){return t.releaseForGroup(e,i,n)})),delete this._resourceNodesMap[e]}},{key:"releaseForGroup",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this._resourceNodesMap[e],o=r.allocated;if(!i)return o[t].map((function(e){return e.audio})).forEach((function(e){return n._destroyNode(e)})),void delete o[t];var a=o[t].filter((function(e){return null===e.soundId})).map((function(e){return e.audio}));a.forEach((function(e){return n._destroyNode(e)})),o[t]=o[t].filter((function(e){return null!==e.soundId}))}},{key:"releaseForSound",value:function(e,t,n){var i=this._resourceNodesMap[e],r=i.allocated,o=i.unallocated;if(t instanceof Audio)this._destroyNode(t),n?r[n]=r[n].filter((function(e){return e.audio!==t})):i.unallocated=o.filter((function(e){return e!==t}));else{var a=r[n].find((function(e){return e.soundId===t}));this._destroyNode(a.audio),r[n]=r[n].filter((function(e){return e.soundId!==t}))}n&&!r[n].length&&delete r[n],!o.length&&!Object.keys(r).length&&delete this._resourceNodesMap[e]}},{key:"cleanUp",value:function(){var e=this;Object.keys(this._resourceNodesMap).forEach((function(t){var n=e._resourceNodesMap[t],i=n.unallocated,r=n.allocated,o=[];Object.keys(r).forEach((function(e){o=[].concat(s(o),s(r[e].filter((function(e){return null===e.soundId})).map((function(e){return e.audio})))),r[e]=r[e].filter((function(e){return null!==e.soundId}))})),n.unallocated=[].concat(s(i),s(o)).slice(0,e._maxNodesPerSource)}))}},{key:"dispose",value:function(){var e=this;Object.keys(this._resourceNodesMap).forEach((function(t){return e.releaseForSource(t)})),this._heap=null}},{key:"hasFreeNodes",value:function(e,t){return!!this._resourceNodesMap.hasOwnProperty(e)&&this._resourceNodesMap[e].allocated[t].filter((function(e){return null===e.soundId})).length>0}},{key:"_createSrc",value:function(e){this._resourceNodesMap.hasOwnProperty(e)||(this._resourceNodesMap[e]={unallocated:[],allocated:{}})}},{key:"_createGroup",value:function(e,t){this._createSrc(e);var n=this._resourceNodesMap[e].allocated;n.hasOwnProperty(t)||(n[t]=[])}},{key:"_checkMaxNodesForSrc",value:function(e){if(this._resourceNodesMap.hasOwnProperty(e)){var t=this._resourceNodesMap[e],n=t.unallocated,i=t.allocated,r=0;if(Object.keys(i).forEach((function(e){r+=i[e].length})),!(n.length+r<this._maxNodesPerSource))throw this._heapCleaned||(this._heap.free(e),this._heapCleaned=!0,this._checkMaxNodesForSrc(e)),this._heapCleaned=!1,new Error("Maximum nodes reached for resource "+e)}}},{key:"_destroyNode",value:function(e){e.pause(),a.default.isIE()&&(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"),e.onerror=null,e.onend=null,e.canplaythrough=null}}]),e}();t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function e(t,n){r(this,e),this.sound=null,this.groupId=null,this.groupId=t,this.sound=n},a=function(){function e(t,n){r(this,e),this._url=null,this.items={},this._inactiveTime=0,this._url=t,this._inactiveTime=n,this.free=this.free.bind(this)}return i(e,[{key:"add",value:function(e,t){var n=t.id().toString();this.items.hasOwnProperty(n)||(this.items[n]=new o(e,t))}},{key:"free",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments[1],i=new Date;Object.values(this.items).forEach((function(r){var o=r.sound,a=r.soundGroupId,s=(i-o.lastPlayed())/1e3;t&&(o.isPersistent()||o.isPlaying()||o.isPaused()||s<60*e._inactiveTime)||Boolean(n)&&a!==n||(o.destroy(),delete e.items[o.id()])}))}},{key:"sounds",value:function(e){var t=Object.values(this.items);return(e?t.filter((function(t){return t.groupId===e})):t).map((function(e){return e.sound}))}},{key:"destroy",value:function(){Object.values(this.items).forEach((function(e){return e.sound.destroy()})),this.items={}}}]),e}(),s=function(){function e(t){r(this,e),this._inactiveTime=0,this._collections={},this._inactiveTime=t,this.free=this.free.bind(this)}return i(e,[{key:"add",value:function(e,t,n){this._collections.hasOwnProperty(e)||(this._collections[e]=new a(e,this._inactiveTime)),this._collections[e].add(t,n)}},{key:"sound",value:function(e){return this.sounds().find((function(t){return t.id()===e}))}},{key:"sounds",value:function(e){var t=[];return Object.values(this._collections).forEach((function(n){return t.push.apply(t,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n.sounds(e)))})),t}},{key:"free",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments[1],n=arguments[2];t?this._collections[t].free(e,n):Object.values(this._collections).forEach((function(t){return t.free(e,n)}))}},{key:"removeSound",value:function(e,t,n){delete this._collections[e].items[n]}},{key:"destroy",value:function(){Object.values(this._collections).forEach((function(e){return e.destroy()})),this._collections={}}}]),e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SoundState=t.default=void 0;var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=u(n(2)),a=u(n(0)),s=u(n(12));u(n(1));function u(e){return e&&e.__esModule?e:{default:e}}var l={Ready:"ready",Playing:"playing",Paused:"paused",Destroyed:"destroyed"},d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=-1,this._volume=1,this._rate=1,this._muted=!1,this._loop=!1,this._state=l.Ready,this._context=null,this._gainNode=null,this._stream=!1,this._buffer=null,this._audio=null,this._bufferSourceNode=null,this._duration=0,this._startPos=0,this._endPos=0,this._currentPos=0,this._rateSeek=0,this._startTime=0,this._loadCallback=null,this._playEndCallback=null,this._destroyCallback=null,this._fading=!1,this._fadeTimer=null,this._fadeEndCallback=null,this._audioErrorCallback=null,this._mediaElementAudioSourceNode=null,this._endTimer=null,this._isSprite=!1,this._lastPlayed=new Date,this._persist=!1,this._onBufferEnded=this._onBufferEnded.bind(this),this._onHtml5Ended=this._onHtml5Ended.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onAudioError=this._onAudioError.bind(this);var n=t.id,i=t.stream,r=t.buffer,s=t.audio,u=t.volume,d=t.rate,h=t.loop,c=t.muted,f=t.startPos,_=t.endPos,p=t.loadCallback,y=t.playEndCallback,v=t.destroyCallback,m=t.fadeEndCallback,b=t.audioErrorCallback;this._id="number"==typeof n?n:a.default.id(),this._buffer=r,this._audio=s,u&&(this._volume=u),d&&(this._rate=d),c&&(this._muted=c),h&&(this._loop=h),f&&(this._startPos=f),_&&(this._endPos=_),this._loadCallback=p,this._playEndCallback=y,this._destroyCallback=v,this._fadeEndCallback=m,this._audioErrorCallback=b,this._stream=Boolean(i),this._endPos=this._stream?this._audio.duration:this._buffer.duration,this._duration=this._endPos-this._startPos,this._isSprite=this._duration<this._endPos,this._stream&&(this._audio.playbackRate=this._rate,this._setLoop(this._loop),this._audio.addEventListener("error",this._onAudioError)),o.default.isAudioAvailable()&&(this._context=o.default.context(),this._gainNode=this._context.createGain(),this._gainNode.gain.setValueAtTime(this._muted?0:this._volume,this._context.currentTime),this._stream&&(this._mediaElementAudioSourceNode=this._context.createMediaElementSource(this._audio),this._mediaElementAudioSourceNode.connect(this._gainNode)))}return r(e,[{key:"load",value:function(){this._stream&&!this.isPlaying()&&this.state()!==l.Destroyed&&(this._audio.addEventListener("canplaythrough",this._onCanPlayThrough),this._audio.currentTime=0,this._audio.readyState>=3&&this._onCanPlayThrough())}},{key:"play",value:function(){return this.isPlaying()?this:(this._stream?this._playHtml5():this._playBuffer(),this._startTime=this._context.currentTime,this._state=l.Playing,this)}},{key:"pause",value:function(){return this.isPlaying()?(this.fadeStop(),this._stream?(this._audio.removeEventListener("ended",this._onHtml5Ended),this._clearEndTimer(),this._audio.pause()):(this._rateSeek=0,this._destroyBufferNode()),this._currentPos=this.seek(),this._state=l.Paused,this):this}},{key:"stop",value:function(){return this.isPlaying()||this.isPaused()?(this.fadeStop(),this._stream?(this._audio.removeEventListener("ended",this._onHtml5Ended),this._clearEndTimer(),this._audio.pause(),this._audio.currentTime=this._startPos||0):(this._currentPos=0,this._rateSeek=0,this._destroyBufferNode()),this._lastPlayed=new Date,this._state=l.Ready,this):this}},{key:"mute",value:function(){return this.fadeStop(),this._gainNode.gain.setValueAtTime(0,this._context.currentTime),this._muted=!0,this}},{key:"unmute",value:function(){return this.fadeStop(),this._gainNode.gain.setValueAtTime(this._volume,this._context.currentTime),this._muted=!1,this}},{key:"volume",value:function(e){return void 0===e?this._volume:(this.fadeStop(),this._gainNode.gain.setValueAtTime(this._muted?0:e,this._context.currentTime),this._volume=e,this)}},{key:"fade",value:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear";return this._fading&&this.fadeStop(),this._fading=!0,"linear"===i?this._gainNode.gain.linearRampToValueAtTime(e,this._context.currentTime+t):this._gainNode.gain.exponentialRampToValueAtTime(e,this._context.currentTime+t),this._fadeTimer=s.default.setTimeout((function(){n.volume(e),s.default.clearTimeout(n._fadeTimer),n._fadeTimer=null,n._fading=!1,n._fadeEndCallback&&n._fadeEndCallback(n)}),1e3*t),this}},{key:"fadeStop",value:function(){return this._fading?(this._gainNode.gain.cancelScheduledValues(this._context.currentTime),this._fadeTimer&&(s.default.clearTimeout(this._fadeTimer),this._fadeTimer=null),this._fading=!1,this.volume(this._gainNode.gain.value),this):this}},{key:"rate",value:function(e){if(void 0===e)return this._rate;if(this._rate=e,this._rateSeek=this.seek(),this.isPlaying())if(this._stream){if(this._audio.playbackRate=e,this._isSprite){this._clearEndTimer();var t=this._getTimeVars(),n=i(t,2)[1];this._endTimer=s.default.setTimeout(this._onHtml5Ended,1e3*n/Math.abs(e))}}else this._startTime=this._context.currentTime,this._bufferSourceNode&&this._bufferSourceNode.playbackRate.setValueAtTime(e,this._context.currentTime);return this}},{key:"seek",value:function(e){if(void 0===e){if(this._stream)return this._audio.currentTime;var t=this.isPlaying()?this._context.currentTime-this._startTime:0,n=this._rateSeek?this._rateSeek-this._currentPos:0;return this._currentPos+(n+t*this._rate)}if(e<this._startPos||e>this._endPos)return this;var i=this.isPlaying();return i&&this.pause(),this._currentPos=e,i&&this.play(),this}},{key:"loop",value:function(e){return"boolean"!=typeof e?this._loop:(this._loop=e,this._setLoop(e),this)}},{key:"destroy",value:function(){return this._state===l.Destroyed?this:(this.stop(),this._destroyMediaSourceNode(),this._audio&&(this._audio.removeEventListener("canplaythrough",this._onCanPlayThrough),this._audio.removeEventListener("error",this._onAudioError)),this._gainNode&&this._gainNode.disconnect(),this._audio=null,this._buffer=null,this._context=null,this._gainNode=null,this._state=l.Destroyed,this._destroyCallback&&this._destroyCallback(this),this)}},{key:"id",value:function(){return this._id}},{key:"muted",value:function(){return this._muted}},{key:"state",value:function(){return this._state}},{key:"duration",value:function(){return this._duration}},{key:"isPlaying",value:function(){return this._state===l.Playing}},{key:"isPaused",value:function(){return this._state===l.Paused}},{key:"lastPlayed",value:function(){return this._lastPlayed}},{key:"persist",value:function(){this._state!==l.Destroyed&&(this._persist=!0)}},{key:"abandon",value:function(){this._state!==l.Destroyed&&(this._persist=!1)}},{key:"isPersistent",value:function(){return this._persist}},{key:"_onAudioError",value:function(e){this._audioErrorCallback&&this._audioErrorCallback(this,e)}},{key:"_getTimeVars",value:function(){var e=Math.max(0,this._currentPos>0?this._currentPos:this._startPos),t=this._endPos-this._startPos;return[e,t,1e3*t/this._rate]}},{key:"_playBuffer",value:function(){var e=this._getTimeVars(),t=i(e,2),n=t[0],r=t[1];this._bufferSourceNode=this._context.createBufferSource(),this._bufferSourceNode.buffer=this._buffer,this._bufferSourceNode.playbackRate.setValueAtTime(this._rate,this._context.currentTime),this._setLoop(this._loop),this._bufferSourceNode.connect(this._gainNode),this._bufferSourceNode.addEventListener("ended",this._onBufferEnded);var o=this._context.currentTime;void 0!==this._bufferSourceNode.start?this._bufferSourceNode.start(o,n,this._loop?void 0:r):this._bufferSourceNode.noteGrainOn(o,n,this._loop?void 0:r)}},{key:"_playHtml5",value:function(){var e=this._getTimeVars(),t=i(e,3),n=t[0],r=t[2];this._audio.currentTime=n,this._isSprite?this._endTimer=s.default.setTimeout(this._onHtml5Ended,r):this._audio.addEventListener("ended",this._onHtml5Ended),this._audio.play()}},{key:"_onBufferEnded",value:function(){this._lastPlayed=new Date,this._currentPos=0,this._rateSeek=0,this._destroyBufferNode(),this._state=l.Ready,this._playEndCallback&&this._playEndCallback(this)}},{key:"_onHtml5Ended",value:function(){this._loop?this.stop().play():(this.stop(),this._state=l.Ready,this._playEndCallback&&this._playEndCallback(this))}},{key:"_clearEndTimer",value:function(){this._endTimer&&(s.default.clearTimeout(this._endTimer),this._endTimer=null)}},{key:"_onCanPlayThrough",value:function(){this._loadCallback(),this._audio.removeEventListener("canplaythrough",this._onCanPlayThrough)}},{key:"_gain",value:function(){return this._gainNode}},{key:"_destroyBufferNode",value:function(){this._bufferSourceNode&&(void 0!==this._bufferSourceNode.stop?this._bufferSourceNode.stop():this._bufferSourceNode.noteGrainOff(),this._bufferSourceNode.disconnect(),this._bufferSourceNode.removeEventListener("ended",this._onBufferEnded),this._bufferSourceNode=null)}},{key:"_destroyMediaSourceNode",value:function(){this._mediaElementAudioSourceNode&&(this._mediaElementAudioSourceNode.disconnect(),this._mediaElementAudioSourceNode=null)}},{key:"_setLoop",value:function(e){this._stream?this._audio.loop=e:(this._bufferSourceNode.loop=e,e&&(this._bufferSourceNode.loopStart=this._startPos,this._bufferSourceNode.loopEnd=this._endPos))}}]),e}();t.default=d,t.SoundState=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._worker=null,this._isWorkerThreadAvailable=!1,this._timerCallbacks={},this._timerId=0,this._handleMessage=this._handleMessage.bind(this)}return i(e,[{key:"init",value:function(){if(Worker&&!this._worker){var e=this._getBlob("\n  var timerIds = {}, timeoutWorker = {};\n  \n  timeoutWorker.setTimeout = function(timerId, duration) {\n    timerIds[timerId] = setTimeout(function() {\n      postMessage({ timerId: timerId });\n    }, duration);\n  };\n  \n  timeoutWorker.clearTimeout = function(timerId) {\n    clearTimeout(timerIds[timerId]);\n  };\n  \n  timeoutWorker.setInterval = function(timerId, duration) {\n    timerIds[timerId] = setInterval(function() {\n      postMessage({ timerId: timerId });\n    }, duration);\n  };\n  \n  timeoutWorker.clearInterval = function(timerId) {\n    clearInterval(timerIds[timerId]);\n  };\n  \n  onmessage = function(e) {\n    var command = e.data.command;\n    timeoutWorker[command](e.data.timerId, e.data.duration);\n  };\n");if(null!==e){var t=this._createObjectURL(e);null!==t&&(this._worker=new Worker(t),this._worker.addEventListener("message",this._handleMessage),this._isWorkerThreadAvailable=!0)}}}},{key:"_getBlob",value:function(e){var t=null;try{t=new Blob([e],{type:"application/javascript"})}catch(i){var n=null;"undefined"!=typeof BlobBuilder?n=BlobBuilder:"undefined"!=typeof WebKitBlobBuilder&&(n=WebKitBlobBuilder),(t=new n).append(e),t=t.getBlob()}return t}},{key:"_createObjectURL",value:function(e){return"undefined"!=typeof URL&&URL.createObjectURL?URL.createObjectURL(e):"undefined"!=typeof webkitURL?webkitURL.createObjectURL(e):null}},{key:"_handleMessage",value:function(e){var t=this._timerCallbacks[e.data.timerId];t&&t.cb&&t.cb(),t.repeat||delete this._timerCallbacks[e.data.timerId]}},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return this._isWorkerThreadAvailable?(this._timerId=this._timerId+1,this._timerCallbacks[this._timerId]={cb:e,repeat:!1},this._worker.postMessage({command:"setTimeout",timerId:this._timerId,duration:t}),this._timerId):setTimeout(e,t)}))},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){if(!this._isWorkerThreadAvailable)return clearTimeout(e);this._worker.postMessage({command:"clearTimeout",timerId:e}),delete this._timerCallbacks[e]}))},{key:"setInterval",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return this._isWorkerThreadAvailable?(this._timerId=this._timerId+1,this._timerCallbacks[this._timerId]={cb:e,repeat:!0},this._worker.postMessage({command:"setInterval",timerId:this._timerId,duration:t}),this._timerId):setInterval(e,t)}))},{key:"clearInterval",value:function(e){if(!this._isWorkerThreadAvailable)return clearTimeout(e);this._worker.postMessage({command:"clearTimeout",timerId:e}),delete this._timerCallbacks[e]}},{key:"terminate",value:function(){this._worker&&(this._worker.removeEventListener("message",this._handleMessage),this._worker.terminate(),this._worker=null),this._isWorkerThreadAvailable=!1,this._timerCallbacks={},this._timerId=0}}]),e}();t.default=new r}])}));